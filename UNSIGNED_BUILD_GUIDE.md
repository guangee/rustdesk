# 不签名构建配置（不推荐）

如果您决定暂时不对 Windows 应用签名，可以按以下方式配置。

## ⚠️ 警告

**不推荐用于任何公开发布！** 原因：
- 用户信任度极低（约 70% 会放弃安装）
- SmartScreen 完全阻止运行
- 企业环境可能无法使用
- 容易被误报为恶意软件

## 如何禁用签名

### 方法 1：不配置 GitHub Secrets

**最简单**：不添加以下 secrets：
- `WINDOWS_CERTIFICATE_BASE64`
- `WINDOWS_CERTIFICATE_PASSWORD`

工作流会自动跳过签名步骤，显示：
```
⚠️  未配置 Windows 证书，跳过签名
```

### 方法 2：注释掉签名步骤

编辑 `.github/workflows/flutter-build.yml`：

```yaml
# - name: Sign rustdesk files
#   if: env.UPLOAD_ARTIFACT == 'true'
#   shell: powershell
#   run: |
#     # 签名代码已注释
```

## 用户如何运行未签名的应用

### Windows 10/11 完整步骤：

#### 1. 下载时
```
浏览器警告：rustdesk.exe 不安全
  → 点击 "..." → "保留"
```

#### 2. 运行时（第一次）
```
SmartScreen: Windows 已保护你的电脑
  → 点击 "更多信息"（小链接）
  → 点击 "仍要运行"
```

#### 3. UAC 提示
```
未验证的发布者
  → 点击 "是"
```

### 企业环境

IT 管理员需要：
```powershell
# 方法 1：解除文件阻止
Unblock-File -Path "rustdesk.exe"

# 方法 2：添加例外到 AppLocker
# 在组策略中配置允许规则

# 方法 3：禁用 SmartScreen（不推荐）
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" -Name "SmartScreenEnabled" -Value "Off"
```

## 给用户的安装说明

创建一个 `INSTALL_UNSIGNED.md` 文件：

```markdown
# 安装 RustDesk（未签名版本）

由于本应用未经代码签名，Windows 会显示安全警告。
这是正常的，以下是安装步骤：

## 步骤 1：下载
下载时，浏览器可能显示警告：
- 点击"..."（更多选项）
- 选择"保留"

## 步骤 2：运行
双击 rustdesk.exe，会看到：
"Windows 已保护你的电脑"

操作：
1. 点击"更多信息"（蓝色小链接）
2. 点击"仍要运行"按钮

## 步骤 3：安装
正常完成安装向导

## 常见问题

Q: 为什么有警告？
A: 应用未签名，Windows 默认阻止未知发布者的软件

Q: 这安全吗？
A: 是的，源代码是开源的，可以自行验证

Q: 如何避免警告？
A: 我们计划在未来版本中添加代码签名
```

## 构建产物说明

未签名的应用：
- 文件名：`rustdesk-1.4.3-x86_64-unsigned.exe`
- 在 Release 中标记为 "Pre-release"
- 添加 "⚠️ UNSIGNED BUILD" 标签

## 统计影响

预期用户流失：
```
下载尝试：   1000 人
成功下载：   700 人  (-30% 浏览器警告)
尝试运行：   350 人  (-50% SmartScreen)
成功安装：   280 人  (-20% UAC/其他)

总成功率：   28%
```

## 替代方案

### 对于开发/测试：
```
✅ 在虚拟机中测试
✅ 禁用 SmartScreen（仅测试机）
✅ 使用内部分发渠道
```

### 对于小范围发布：
```
✅ 使用自签名证书（当前配置）
✅ 提供详细安装说明
✅ 通过信任渠道分发（论坛、社区）
```

### 对于公开发布：
```
✅ 购买代码签名证书
✅ 建议预算：$200-400/年
✅ 建立应用信誉（6-12个月）
```

## 法律和声明

未签名分发时，建议添加免责声明：

```
本软件按"原样"提供，不提供任何明示或暗示的保证。
使用本软件的风险由用户自行承担。

由于未经代码签名，操作系统可能显示安全警告。
这是正常的，但请自行判断是否信任本软件。
```

## 何时应该签名

**立即签名，如果：**
- ❗ 面向非技术用户
- ❗ 公开发布（超过 100 用户）
- ❗ 需要企业客户
- ❗ 涉及敏感数据

**可以暂缓，如果：**
- ✅ 仅内部使用
- ✅ 开发/测试阶段
- ✅ 用户全部是技术人员
- ✅ 预算非常紧张

---

**建议：** 即使预算有限，也应使用自签名证书（免费），
至少能减少一些安全警告。

